{"triggers":[],"nodes":[{"uid":"5b39c567-868b-4b0d-8ca4-0a01a3e14ec8","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a8cb6d1d-707f-4329-b103-55fa3beb89a4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"004b9aaa-678c-4891-ba20-f4cb13b8a783","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vProcessFlow$.Get records from DB with status READY-FOR-IQBOT"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessFlow"}},{"uid":"cf7f8b91-9b0e-4c10-82bc-574835d73d8b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6b78ceac-4755-4f82-bc86-c942313c0272","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\ReadyForIQBot"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\ReadyForIQBot"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"d0ff0c58-e705-4cbc-aa0a-4e533087cd6f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\ReadyForIQBot\\Records.csv"}}],"returnTo":{"type":"VARIABLE","variableName":"vCSVFilePath"}},{"uid":"ad70a1a5-f2d6-439d-812b-520c61967525","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"96f5e04a-951e-4155-89eb-172abd680d17","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"vQueryScript","value":{"type":"STRING","expression":"$vSQLQuery$"}},{"key":"vCSVFilePath","value":{"type":"STRING","expression":"$vCSVFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Reusable%20Components/QueryRecord"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Upload to IQBot and Update status to Database"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get IQBot records form database"}}]},{"uid":"fcb3c733-f75e-4f7e-bbf8-854489a13a54","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"90fef493-1a52-41f2-9b22-19d2419b882b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vProcessFlow$.Open CSV file to upload to IQBot"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessFlow"}},{"uid":"05a988a0-e61d-4152-9115-7d30689c9566","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"IQBotUpload"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vCSVFilePath$"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"d54e4c6d-d79d-413f-b98f-9e0f7e5909b7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"b5feeae6-35a3-4640-9a68-df8ea939a4b4","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MM/dd/yyyy HH:mm:ss"}}],"returnTo":{"type":"VARIABLE","variableName":"vStartTime"}},{"uid":"7c94527a-e947-4959-aec7-80ae75fd9c6d","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MM/dd/yyyy HH:mm:ss"}}],"returnTo":{"type":"VARIABLE","variableName":"vDate"}},{"uid":"f74e18c6-0dc4-4c4d-9ff7-52e4b73edd90","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$vRowCounter$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vRowCounter"}},{"uid":"45e8364e-c1c7-4151-a8cc-7f7e0ad04e04","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\TiffFiles"}}],"returnTo":{"type":"VARIABLE","variableName":"vTiffSourceFolderPath"}},{"uid":"55e6900b-6375-4cba-b8cf-a2234d7a2c91","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rRecord[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCurrentFileName"}},{"uid":"3796c187-a66a-4d69-a497-11919ca87995","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"56e87172-222b-4f68-96b6-e6b7596ee9e0","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vPDFFormat"}},{"uid":"9c40dae6-395a-4e29-91db-06ec2f6516cc","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$rRecord[1]$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"57fabd6b-aaf6-4bcf-8f7d-34999af01461","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"3236c216-c406-4a3a-a2fe-9857a124c3dd","commandName":"extractImage","packageName":"PDF","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$rRecord[1]$"}},{"name":"userSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"ownerSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"pageOption","value":{"type":"STRING","string":"SELECTED"}},{"name":"selectedPages","value":{"type":"STRING","string":"1-1"}},{"name":"imageFileType","value":{"type":"STRING","string":"JPEG"}},{"name":"jpegQuality","value":{"type":"NUMBER","number":"100"}},{"name":"outputDirectory","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$"}},{"name":"filePrefix","value":{"type":"STRING","string":"temp"}},{"name":"overwriteFile","value":{"type":"BOOLEAN","boolean":true}},{"name":"resolutionX","value":{"type":"NUMBER","number":"200"}},{"name":"resolutionY","value":{"type":"NUMBER","number":"200"}},{"name":"imageColorType","value":{"type":"STRING","string":"RGB"}},{"name":"imageColorBitsRgb","value":{"type":"STRING","string":"BITS_32"}}]},{"uid":"0934b3ac-9c29-4c4f-91a2-4d3d17aefdff","commandName":"captureImagebyPath","packageName":"OCR","disabled":false,"attributes":[{"name":"imagePath","value":{"type":"FILE","expression":"file://$dBotConfig{vTempPath}$/temp_1.jpeg"}},{"name":"checkFilterText","value":{"type":"BOOLEAN","boolean":false}},{"name":"checkTrimText","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadProfile","value":{"type":"BOOLEAN","boolean":false}},{"name":"ocrLocale","value":{"type":"STRING","string":"Based on Locale"}}],"returnTo":{"type":"VARIABLE","variableName":"vOCRText"}}],"branches":[{"uid":"c01f017f-3b72-4886-9a73-a8d97cee07d6","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f59975e8-67d1-4b1d-aa6d-78f53753adb0","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$dBotConfig{vP1Recipients}$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Warning: You should not see this. Contact IT. "}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","string":"Error in IQBotUpload function, because some unhandled file or exception"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"367f3632-4d3c-4879-95a9-6fca029d192e","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Warning: You should not see this. Contact IT."}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"99"}}]},{"uid":"3ed3826f-e2c0-40e5-b3e7-518e3f911ffd","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]},{"uid":"9dde89a4-ed41-4814-bcb6-7f181575fe24","commandName":"OpenSpreadsheet","packageName":"Excel","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"PDFTemplate"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$dBotConfig{vConfigPath}$/BusinessConfiguration.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":true}},{"name":"sheetName","value":{"type":"STRING","string":"PDFTemplate"}},{"name":"fileAccessMode","value":{"type":"STRING","string":"READ_ONLY"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Check PDF template"}}]},{"uid":"b48bce21-2a66-4729-82b6-ee167f7afd3b","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"3d5440ea-befb-4435-ada7-86e8b41c3abf","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4f46528d-2b43-4012-b54e-d4005a8bdefe","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vOCRText$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6e7e1ca3-b1ee-4270-b37c-3050ef40416a","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vPDFFormat"}},{"uid":"017ebc6a-5053-4317-8b97-9bf8faf48ab8","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vOCRText$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$rPDFTemplate[0]$"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rPDFTemplate"},"attributes":[{"name":"session","value":{"type":"STRING","string":"PDFTemplate"}},{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.excel","packageName":"Excel"}}]},{"uid":"05f87d76-3763-4757-82da-097bbe3858f5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"8801a0c3-0d7c-441a-8993-0ffe29b02041","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"47aa5a77-cb95-40e1-8d6d-e470fe061ebf","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1f600975-93f6-433b-96c0-5a5a692a4888","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\TiffFiles"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\TiffFiles"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]},{"uid":"7f303c15-0333-496d-808d-6730a890295d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"45ab5475-97e6-4d69-a953-5b7d64db9a86","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\TiffFiles"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$dBotConfig{vTempPath}$\\TiffFiles"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"e28531f3-8434-4fb4-bba8-552a38250f48","commandName":"extractImage","packageName":"PDF","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$rRecord[1]$"}},{"name":"userSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"ownerSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"pageOption","value":{"type":"STRING","string":"ALL"}},{"name":"imageFileType","value":{"type":"STRING","string":"TIFF"}},{"name":"tiffCompressionType","value":{"type":"STRING","string":"LZW"}},{"name":"outputDirectory","value":{"type":"STRING","expression":"$vTiffSourceFolderPath$"}},{"name":"filePrefix","value":{"type":"STRING","string":"Temp"}},{"name":"overwriteFile","value":{"type":"BOOLEAN","boolean":true}},{"name":"resolutionX","value":{"type":"NUMBER","number":"200"}},{"name":"resolutionY","value":{"type":"NUMBER","number":"200"}},{"name":"imageColorType","value":{"type":"STRING","string":"GRAY"}},{"name":"imageColorBitsGray","value":{"type":"STRING","string":"BITS_32"}}]},{"uid":"42fbbea7-5da6-48bf-b0d9-f6a59f337214","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rRecord[1]$"}},{"name":"find","value":{"type":"STRING","string":".pdf"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":".tiff"}}],"returnTo":{"type":"VARIABLE","variableName":"vTiffTargetFilePath"}},{"uid":"e8880ff1-2ebb-4450-8306-012301646a8a","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rRecord[1]$"}},{"name":"find","value":{"type":"STRING","string":".pdf"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":".tiff"}}],"returnTo":{"type":"VARIABLE","variableName":"vCurrentFileName"}},{"uid":"3561b1fb-b82a-4532-a946-e4fe56e10807","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$rRecord[1]$-$vTiffTargetFilePath$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"56d2ef0b-23ba-417f-abb5-14f747237da8","commandName":"put","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dPDFtoTiff"}},{"name":"key","value":{"type":"STRING","string":"sourceFolder"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"vTiffSourceFolderPath"}}],"returnTo":{"type":"VARIABLE","variableName":"vTiffSourceFolderPath"}},{"uid":"6193e73b-565c-44d7-9df8-36cc2a02a887","commandName":"put","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dPDFtoTiff"}},{"name":"key","value":{"type":"STRING","string":"targetFilePath"}},{"name":"newValue","value":{"type":"VARIABLE","variableName":"vTiffTargetFilePath"}}],"returnTo":{"type":"VARIABLE","variableName":"vTiffTargetFilePath"}},{"uid":"629c321a-5d42-4a44-a15e-aa755f836099","commandName":"Open","packageName":"DLL","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"file","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Finance/AP/Supplier%20Invoice%20Processing/Dependencies/TiffHelper.dll"}}]},{"uid":"ce8fea53-346c-4c9c-8fba-abfab3bdccc9","commandName":"Run function","packageName":"DLL","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"nameSpace","value":{"type":"STRING","string":"TiffHelper"}},{"name":"className","value":{"type":"STRING","string":"TiffHelperClass"}},{"name":"functionName","value":{"type":"STRING","string":"MergeAllFiles"}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"dPDFtoTiff"}}]},{"uid":"fd13017b-f537-434f-8490-b52106ac3be9","commandName":"Close","packageName":"DLL","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"556cd6a1-4075-46f9-9949-6b1dce17f0e2","commandName":"waitForCondition","packageName":"Wait","disabled":false,"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$dPDFtoTiff{targetFilePath}$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"20"}}],"name":"conditionPredicate","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]},{"uid":"3496123e-9d81-457b-bc50-980f70d94efc","commandName":"if","packageName":"If","disabled":true,"children":[],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$rRecord[1]$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$rRecord[3]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$vEmptyString$"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Convert PDF to Tiff"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$vPDFFormat$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":false}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"25e2e5da-c39e-42af-9dfb-d66059892abb","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$@IQBotControlRoomURL$ - $@IQBotUserName$- $@IQBotPassword$ - $@IQBotLearningInstanceId$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6cf1b742-4901-4b93-ae90-fe4390254923","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"sControlRoomUrl","value":{"type":"STRING","expression":"$@IQBotControlRoomURL$"}},{"key":"sUserName","value":{"type":"STRING","expression":"$@IQBotUserName$"}},{"key":"sPassword","value":{"type":"STRING","expression":"$@IQBotPassword$"}},{"key":"sLearningInstanceId","value":{"type":"STRING","expression":"$@IQBotLearningInstanceId$"}},{"key":"sFilePath","value":{"type":"STRING","expression":"$vCurrentFileName$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Reusable%20Components/IQBotUploadFile"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"dFileUpload"}},{"uid":"47700741-ca36-4711-9732-2f70a0d62ad7","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$rRecord[1]$-$dPDFtoTiff{targetFilePath}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ced890ab-b181-4a34-9582-063a61a9242e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vConstUpdateScript$"}}],"returnTo":{"type":"VARIABLE","variableName":"vUpdateScript"}},{"uid":"a96f4c5d-5246-45b8-8545-fb96a02ba290","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vUpdateScript$"}},{"name":"find","value":{"type":"STRING","string":"vId"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$rRecord[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vUpdateScript"}},{"uid":"a1a079c3-b4e3-4502-a9c4-5c7c19ca02c2","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vUpdateScript$"}},{"name":"find","value":{"type":"STRING","string":"vProcessFlow"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":".Call 1.2_IQBotUpload.Status.$dFileUpload{sOutStatus}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vUpdateScript"}},{"uid":"874f7abb-584d-4499-bff0-33e82fa2f1f2","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vUpdateScript$"}},{"name":"find","value":{"type":"STRING","string":"vStartTime"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vStartTime$"}}],"returnTo":{"type":"VARIABLE","variableName":"vUpdateScript"}},{"uid":"ea0a7e91-b3a2-4bc4-9602-370f672bce4c","commandName":"replace","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vUpdateScript$"}},{"name":"find","value":{"type":"STRING","string":"vINVFileName"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$vCurrentFileName$"}}],"returnTo":{"type":"VARIABLE","variableName":"vUpdateScript"}},{"uid":"4f0378cd-0655-4b73-b3d6-ccb5d92e5b31","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vUpdateScript$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"0dea6e6d-1cf2-4ca5-be87-61a7078c91c2","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"vInsertScript","value":{"type":"STRING","expression":"$vUpdateScript$"}},{"key":"vProcessFlow","value":{"type":"STRING","expression":"$vProcessFlow$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Reusable%20Components/InsertRecord"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"42688954-73d0-4edc-ac48-bd15d4684520","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MM/dd/yyyy HH:mm:ss"}}],"returnTo":{"type":"VARIABLE","variableName":"vEndTime"}},{"uid":"da55898e-4591-4ce9-97e3-e03454eb3ced","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$dBotConfig{vAuditLogPath}$/AuditTrails.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"=============================================================\nDate : $vDate$ \nProcessFlow : $vProcessFlow$\nStatus : $vStatus$ \nRemark: $vRemark$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"1fef01b1-1ccf-48fb-a122-10f78fc00a57","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$dBotConfig{vOutputPath}$/Output.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"IQBot Upload File,$rRecord[1]$,$vStatus$,$vRemark$,$vProcessFlow$,$vStartTime$,$vEndTime$,$System:Machine$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"e5bf902a-b445-47d5-82f2-7c38ccbdde9f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmptyString$"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessFlow"}},{"uid":"4b154541-1d9a-49d9-aaed-e8e9d93c588a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmptyString$"}}],"returnTo":{"type":"VARIABLE","variableName":"vRemark"}},{"uid":"c8da0079-8997-4d2d-8875-51d0d11e9701","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmptyString$"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"c0ac3196-38ed-4ff1-a8ca-90c8688b6901","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$dFileUpload{sOutStatus}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"IQBotUpload"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.csvtxt","packageName":"CsvTxt"}}]},{"uid":"c6e9977e-1521-4c3a-a2e5-37051ee4b36a","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"IQBotUpload"}}]},{"uid":"25b27cbe-f63c-4340-bca3-deca17cc5a8e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4e4248c6-368f-4c6a-842d-6395feba212b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vProcessFlow$.No Records to IQBot"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessFlow"}}],"branches":[{"uid":"172c3747-141f-4094-9c02-a35d3053f776","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"12f18677-8d4b-4c80-88fa-999c10cc3a59","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vRowCounter$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vStrRowCounter"}},{"uid":"1c58142c-4e88-4b3e-be37-d20e3aa9b5f6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vProcessFlow$.$vStrRowCounter$ reocres uploaded to IQBot"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessFlow"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$vRowCounter$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"285f7aef-5b07-4d34-993a-5c1fef2140a7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vProcessFlow$.End 1.2_IQBotUpload"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessFlow"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Update status to DB"}}]}],"branches":[{"uid":"a209ed19-acbd-499b-bf58-916291f06349","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"363a5cbd-3286-4f5f-a4ff-32160d127b55","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Technical Exception"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"7969ddd2-f359-4ab2-b26a-2fc509988179","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vStrErrorLineNumber"}},{"uid":"14929b3f-ac09-4591-9608-2841068e77d7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"1.2_1QBotUpload Error at $vStrErrorLineNumber$ Msg $vErrorMessage$"}}],"returnTo":{"type":"VARIABLE","variableName":"vRemark"}},{"uid":"fff67cc5-cee8-4f18-8106-02b15e243f7f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vProcessFlow$.$vRemark$"}}],"returnTo":{"type":"VARIABLE","variableName":"vProcessFlow"}},{"uid":"4af82d6a-4c60-464a-89a5-5b68176a9594","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vRemark$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"444b781c-6ab3-477e-835c-05db8c10925d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$dBotConfig{vErrorLogPath}$/ErrorLog.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"=====================================================\nTask Name: IQBot Upload\nError Description: $vRemark$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vCSVFilePath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSQLQuery","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"select ID,INV_File_path, INV_File_Name, EntryID from [Invoice_Records] WHERE Validation_Status = 'True' AND Current_Status='READY-FOR-IQBOT'"}},{"name":"vRecordCounter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vUpdateScript","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numberOfRows","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false,"readOnly":false},{"name":"rRecord","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false,"readOnly":false},{"name":"vConstUpdateScript","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"UPDATE Invoice_RecordS SET Process_Flow=Process_Flow+'vProcessFlow', Current_Status = 'IQBOT-IN-PROGRESS', IQBot_UploadTime='vStartTime' where Id = vId"}},{"name":"dIQBotConfig","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"IQBotUploadStatus","description":"","type":"ANY","subtype":"UNDEFINED","input":false,"output":false,"readOnly":false},{"name":"vProcessFlow","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"dFileUpload","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vStrErrorLineNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vRowCounter","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vStrRowCounter","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vRemark","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"dBotConfig","description":"","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"vTempPath","value":{"type":"STRING","string":"C:\\SupplierInvoiceProcessing\\Temp"}},{"key":"vAuditLogPath","value":{"type":"STRING","string":"C:\\SupplierInvoiceProcessing\\Log\\2020\\04\\27"}},{"key":"vOutputPath","value":{"type":"STRING","string":"C:\\SupplierInvoiceProcessing\\Output\\2020\\04\\27"}},{"key":"vErrorLogPath","value":{"type":"STRING","string":"C:\\SupplierInvoiceProcessing\\ErrorLog\\2020\\04\\27"}}]}},{"name":"vStatus","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vStartTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vEndTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vEmptyString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dPDFtoTiff","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"sourceFolder","value":{"type":"STRING","string":""}},{"key":"targetFilePath","value":{"type":"STRING","string":""}}]}},{"name":"vTiffSourceFolderPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTiffTargetFilePath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTempINVFileName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCurrentFileName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vOCRText","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rPDFTemplate","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vPDFFormat","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.0.0-20200418-005329"},{"name":"CsvTxt","version":"2.0.0-20200205-175938"},{"name":"Datetime","version":"2.0.0-20200131-090006"},{"name":"Dictionary","version":"2.0.0-20200302-135932"},{"name":"DLL","version":"2.0.0-20200418-005620"},{"name":"Email","version":"2.0.0-20200418-005352"},{"name":"ErrorHandler","version":"2.0.0-20200130-183452"},{"name":"Excel","version":"2.0.0-20200422-000204"},{"name":"File","version":"2.0.0-20200316-045955"},{"name":"Folder","version":"2.0.0-20200131-090021"},{"name":"If","version":"2.0.0-20200131-090025"},{"name":"LogToFile","version":"2.0.0-20200131-090040"},{"name":"Loop","version":"2.0.0-20200131-090041"},{"name":"MessageBox","version":"2.0.0-20200131-090041"},{"name":"Number","version":"2.0.0-20200205-110015"},{"name":"OCR","version":"2.1.0-20200418-005434"},{"name":"PDF","version":"2.1.0-20200302-140126"},{"name":"Step","version":"2.0.0-20200205-230315"},{"name":"String","version":"2.0.0-20200131-090323"},{"name":"System","version":"2.0.0-20200205-110240"},{"name":"TaskBot","version":"2.0.0-20200417-230837"},{"name":"Wait","version":"2.0.0-20200302-140319"}],"workItemTemplateName":null}